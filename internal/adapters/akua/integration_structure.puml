@startuml Integration Structure

title Akua Project - Integration Architecture Structure

skinparam componentStyle rectangle
skinparam linetype ortho

package "Domain Layer" {
    [authorization.Provider\n<<interface>>] as AuthPort
    [authorization.Service] as AuthService
    [authorization.Authorization\nDomain Model] as AuthDomain
    
    [commerce.Provider\n<<interface>>] as CommercePort
    [commerce.Service] as CommerceService
    [commerce.Commerce\nDomain Model] as CommerceDomain
    
    [organization.Provider\n<<interface>>] as OrgPort
    [organization.Service] as OrgService
    [organization.Organization\nDomain Model] as OrgDomain
    
    [payment.Provider\n<<interface>>] as PaymentPort
    [payment.Service] as PaymentService
    [payment.Payment\nDomain Model] as PaymentDomain
    
    [instruments\nDomain Models] as InstrumentDomain
    note right of InstrumentDomain
        - Instrument
        - AmountObject
        - InstrumentObject
        - CaptureObject
    end note
}

package "Adapter Layer - Akua" {
    [akua.Client] as Client
    note right of Client
        - HTTP Client
        - JWT Token Management
        - OAuth Token Loading
        - Configuration
    end note
    
    [akua.authorization\nAuthorizationProvider] as AuthAdapter
    note right of AuthAdapter
        - Authorize()
        - POST /v1/authorizations
    end note
    
    [akua.commerce\nCommerceProvider] as CommerceAdapter
    note right of CommerceAdapter
        - GetOrganizationCommerces()
        - CreateCommerce()
        - GetCommerceById()
        - DeleteCommerce()
        - UpdateCommerce()
        - UpdateCommerceRails()
    end note
    
    [akua.organizations\nOrganizationProvider] as OrgAdapter
    note right of OrgAdapter
        - GetOrganizations()
        - GET /v1/organizations
    end note
    
    [akua.payments\nPaymentsProvider] as PaymentAdapter
    note right of PaymentAdapter
        - GetPayments()
        - GET /v1/payments
    end note
    
    [akua.errors] as Errors
    note right of Errors
        - ErrJWTTokenNotSet
    end note
}

cloud "External System" {
    [Akua API] as AkuaAPI
    note right of AkuaAPI
        REST API Endpoints:
        - /oauth/token
        - /v1/authorizations
        - /v1/merchants
        - /v1/organizations
        - /v1/payments
    end note
}

' Domain Relationships
AuthService ..> AuthPort : uses
AuthService ..> AuthDomain : returns
CommerceService ..> CommercePort : uses
CommerceService ..> CommerceDomain : returns
OrgService ..> OrgPort : uses
OrgService ..> OrgDomain : returns
PaymentService ..> PaymentPort : uses
PaymentService ..> PaymentDomain : returns

' Adapter Implementations
AuthAdapter ..|> AuthPort : implements
CommerceAdapter ..|> CommercePort : implements
OrgAdapter ..|> OrgPort : implements
PaymentAdapter ..|> PaymentPort : implements

' Adapter Dependencies
AuthAdapter --> Client : uses
AuthAdapter --> Errors : uses
AuthAdapter --> InstrumentDomain : uses
CommerceAdapter --> Client : uses
CommerceAdapter --> Errors : uses
OrgAdapter --> Client : uses
OrgAdapter --> Errors : uses
PaymentAdapter --> Client : uses
PaymentAdapter --> Errors : uses

' Client to External API
Client --> AkuaAPI : HTTP Requests\nJWT Token Management
AuthAdapter --> AkuaAPI : POST /v1/authorizations
CommerceAdapter --> AkuaAPI : GET/POST/PUT /v1/merchants
OrgAdapter --> AkuaAPI : GET /v1/organizations
PaymentAdapter --> AkuaAPI : GET /v1/payments

' Domain Model Dependencies
AuthDomain --> InstrumentDomain : references
AuthAdapter --> AuthDomain : converts to/from
CommerceAdapter --> CommerceDomain : converts to/from
OrgAdapter --> OrgDomain : converts to/from
PaymentAdapter --> PaymentDomain : converts to/from

legend right
    |= Layer |= Purpose |
    | **Domain** | Business logic, interfaces, and domain models |
    | **Service** | Orchestration layer wrapping providers |
    | **Adapter** | External integration implementations |
    | **Client** | HTTP communication and authentication |
    | **External** | Akua API - Payment processing platform |
endlegend

@enduml

