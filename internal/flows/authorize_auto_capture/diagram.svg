<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2934px" preserveAspectRatio="none" style="width:1447px;height:2934px;background:#FAFAFA;" version="1.1" viewBox="0 0 1447 2934" width="1447px" zoomAndPan="magnify"><title>Complete Authorization Flow - Payment Command</title><defs/><g><rect fill="#FAFAFA" height="2934" style="stroke:none;stroke-width:1;" width="1447" x="0" y="0"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="397.6123" x="520.853" y="27.9951">Complete Authorization Flow - Payment Command</text><g><title>cmd/flows</title><rect fill="#FFFFFF" height="286.5938" style="stroke:#181818;stroke-width:1;" width="10" x="408.8706" y="224.2891"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="189.0625" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="253.4219"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="168.7969" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="554.8203"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="1217.6797"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="1527.6172"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="1787.9453"/></g><g><title>akua.authorization</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="1044.5303" y="969.3516"/></g><g><title>akua.authorization</title><rect fill="#FFFFFF" height="154.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1044.5303" y="1145.4141"/></g><g><title>Akua API</title><rect fill="#FFFFFF" height="82.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1324.9731" y="641.2188"/></g><g><title>Akua API</title><rect fill="#FFFFFF" height="97.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1324.9731" y="1861.3438"/></g><rect fill="none" height="440.6016" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1370.3184" x="50" y="457.4844"/><rect fill="none" height="234.8672" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1350.3184" x="60" y="656.2188"/><rect fill="none" height="1558.2031" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1420.3184" x="10" y="1261.8125"/><rect fill="none" height="1396.7344" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1400.3184" x="20" y="1416.2813"/><rect fill="none" height="929.6719" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1380.3184" x="30" y="1876.3438"/><rect fill="none" height="667.8047" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1223.0605" x="40" y="2131.2109"/><rect fill="none" height="460.9375" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1092.5117" x="50" y="2212.6094"/><rect fill="none" height="209.8047" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="413.0039" x="60" y="2456.7422"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2702.125" width="8" x="107.1958" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="111" x2="111" y1="134.8906" y2="2837.0156"/></g><g><title>cmd/flows</title><rect fill="#000000" fill-opacity="0.00000" height="2702.125" width="8" x="409.8706" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="413.7373" x2="413.7373" y1="134.8906" y2="2837.0156"/></g><g><title>akua.Client</title><rect fill="#000000" fill-opacity="0.00000" height="2702.125" width="8" x="710.0674" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="713.5078" x2="713.5078" y1="134.8906" y2="2837.0156"/></g><g><title>akua.authorization</title><rect fill="#000000" fill-opacity="0.00000" height="2702.125" width="8" x="1045.5303" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1048.5488" x2="1048.5488" y1="134.8906" y2="2837.0156"/></g><g><title>Akua API</title><rect fill="#000000" fill-opacity="0.00000" height="2702.125" width="8" x="1325.9731" y="134.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1329.6279" x2="1329.6279" y1="134.8906" y2="2837.0156"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="92.2407" y="115.292">User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.3916" x="70" y="131.5889">(runs cmd)</text><ellipse cx="111.1958" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M111.1958,58.7969 L111.1958,85.7969 M98.1958,66.7969 L124.1958,66.7969 M111.1958,85.7969 L98.1958,100.7969 M111.1958,85.7969 L124.1958,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="92.2407" y="2849.0107">User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.3916" x="70" y="2865.3076">(runs cmd)</text><ellipse cx="111.1958" cy="2877.1094" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M111.1958,2885.1094 L111.1958,2912.1094 M98.1958,2893.1094 L124.1958,2893.1094 M111.1958,2912.1094 L98.1958,2927.1094 M111.1958,2912.1094 L124.1958,2927.1094" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="CmdFlow"><rect fill="#E2E2F0" height="46.5938" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="98.2666" x="364.7373" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.0664" x="378.3374" y="107.292">cmd/flows</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.2666" x="371.7373" y="123.5889">payment.go</text></g><g class="participant participant-tail" data-participant="CmdFlow"><rect fill="#E2E2F0" height="46.5938" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="98.2666" x="364.7373" y="2836.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.0664" x="378.3374" y="2856.0107">cmd/flows</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.2666" x="371.7373" y="2872.3076">payment.go</text></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="93.1191" x="667.5078" y="103.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.1191" x="674.5078" y="123.5889">akua.Client</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="93.1191" x="667.5078" y="2836.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.1191" x="674.5078" y="2856.0107">akua.Client</text></g><g class="participant participant-head" data-participant="AuthProvider"><rect fill="#E2E2F0" height="46.5938" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="165.9629" x="966.5488" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.3594" x="983.8506" y="107.292">akua.authorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.9629" x="973.5488" y="123.5889">AuthorizationProvider</text></g><g class="participant participant-tail" data-participant="AuthProvider"><rect fill="#E2E2F0" height="46.5938" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="165.9629" x="966.5488" y="2836.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.3594" x="983.8506" y="2856.0107">akua.authorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.9629" x="973.5488" y="2872.3076">AuthorizationProvider</text></g><g class="participant participant-head" data-participant="AkuaAPI"><rect fill="#E2E2F0" height="46.5938" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="140.6904" x="1259.6279" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7354" x="1299.1055" y="107.292">Akua API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.6904" x="1266.6279" y="123.5889">/v1/authorizations</text></g><g class="participant participant-tail" data-participant="AkuaAPI"><rect fill="#E2E2F0" height="46.5938" rx="5" ry="5" style="stroke:#181818;stroke-width:0.5;" width="140.6904" x="1259.6279" y="2836.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7354" x="1299.1055" y="2856.0107">Akua API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.6904" x="1266.6279" y="2872.3076">/v1/authorizations</text></g><g><title>cmd/flows</title><rect fill="#FFFFFF" height="286.5938" style="stroke:#181818;stroke-width:1;" width="10" x="408.8706" y="224.2891"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="189.0625" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="253.4219"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="168.7969" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="554.8203"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="1217.6797"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="1527.6172"/></g><g><title>akua.Client</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="709.0674" y="1787.9453"/></g><g><title>akua.authorization</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="1044.5303" y="969.3516"/></g><g><title>akua.authorization</title><rect fill="#FFFFFF" height="154.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1044.5303" y="1145.4141"/></g><g><title>Akua API</title><rect fill="#FFFFFF" height="82.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1324.9731" y="641.2188"/></g><g><title>Akua API</title><rect fill="#FFFFFF" height="97.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1324.9731" y="1861.3438"/></g><rect fill="#EEEEEE" height="3" rx="5" ry="5" style="stroke:#EEEEEE;stroke-width:1;" width="1440.3184" x="0" y="165.457"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1440.3184" y1="165.457" y2="165.457"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1440.3184" y1="168.457" y2="168.457"/><rect fill="#EEEEEE" height="23.1328" rx="5" ry="5" style="stroke:#000000;stroke-width:2;" width="159.2598" x="640.5293" y="154.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.7339" x="646.5293" y="170.9575">Initialization Phase</text><g class="message" data-participant-1="User" data-participant-2="CmdFlow"><polygon fill="#181818" points="396.8706,220.2891,406.8706,224.2891,396.8706,228.2891,400.8706,224.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="111.1958" x2="402.8706" y1="224.2891" y2="224.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.9111" x="118.1958" y="204.0903">go run cmd/flows/payment.go</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.1753" x="118.1958" y="219.2231">(or similar command)</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="Client"><polygon fill="#181818" points="697.0674,249.4219,707.0674,253.4219,697.0674,257.4219,701.0674,253.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="418.8706" x2="703.0674" y1="253.4219" y2="253.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.1338" x="425.8706" y="248.356">NewClient()</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#181818;stroke-width:2;" x1="719.0674" x2="761.0674" y1="358.2188" y2="358.2188"/><line style="stroke:#181818;stroke-width:2;" x1="761.0674" x2="761.0674" y1="358.2188" y2="371.2188"/><line style="stroke:#181818;stroke-width:2;" x1="720.0674" x2="761.0674" y1="371.2188" y2="371.2188"/><polygon fill="#181818" points="730.0674,367.2188,720.0674,371.2188,730.0674,375.2188,726.0674,371.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.3545" x="726.0674" y="277.4888">Load environment variables:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.5269" x="726.0674" y="292.6216">- AKUA_CLIENT_ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.4131" x="726.0674" y="307.7544">- AKUA_CLIENT_SECRET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.6313" x="726.0674" y="322.8872">- AKUA_AUDIENCE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8149" x="726.0674" y="338.02">- AKUA_ORGANIZATION_ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.7734" x="726.0674" y="353.1528">- AKUA_COMMERCE_ID</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#181818;stroke-width:2;" x1="719.0674" x2="761.0674" y1="400.3516" y2="400.3516"/><line style="stroke:#181818;stroke-width:2;" x1="761.0674" x2="761.0674" y1="400.3516" y2="413.3516"/><line style="stroke:#181818;stroke-width:2;" x1="720.0674" x2="761.0674" y1="413.3516" y2="413.3516"/><polygon fill="#181818" points="730.0674,409.3516,720.0674,413.3516,730.0674,417.3516,726.0674,413.3516" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.1333" x="726.0674" y="395.2856">Validate all env vars are set</text></g><g class="message" data-participant-1="Client" data-participant-2="CmdFlow"><polygon fill="#181818" points="429.8706,438.4844,419.8706,442.4844,429.8706,446.4844,425.8706,442.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="423.8706" x2="713.0674" y1="442.4844" y2="442.4844"/><ellipse cx="441.3706" cy="432.9844" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.3276" x="447.8706" y="437.4185">Client (or error)</text></g><path d="M55,457.4844 L114.4429,457.4844 L114.4429,464.6172 L104.4429,474.6172 L50,474.6172 L50,462.4844 A5,5 0 0 1 55,457.4844" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="440.6016" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1370.3184" x="50" y="457.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="65" y="470.5513">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="144.4878" x="129.4429" y="469.6948">[Client Creation Failed]</text><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,506.8828,112.1958,510.8828,122.1958,514.8828,118.1958,510.8828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="510.8828" y2="510.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.2852" x="128.1958" y="490.6841">Return Error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.4077" x="128.1958" y="505.8169">(Missing environment variable)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="50" x2="1420.3184" y1="519.8828" y2="519.8828"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="179.5288" x="55" y="530.0933">[Client Created Successfully]</text><g class="message" data-participant-1="CmdFlow" data-participant-2="Client"><polygon fill="#181818" points="697.0674,550.8203,707.0674,554.8203,697.0674,558.8203,701.0674,554.8203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="413.8706" x2="703.0674" y1="554.8203" y2="554.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.7817" x="420.8706" y="549.7544">LoadJwtToken()</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#181818;stroke-width:2;" x1="719.0674" x2="761.0674" y1="599.0859" y2="599.0859"/><line style="stroke:#181818;stroke-width:2;" x1="761.0674" x2="761.0674" y1="599.0859" y2="612.0859"/><line style="stroke:#181818;stroke-width:2;" x1="720.0674" x2="761.0674" y1="612.0859" y2="612.0859"/><polygon fill="#181818" points="730.0674,608.0859,720.0674,612.0859,730.0674,616.0859,726.0674,612.0859" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.6943" x="726.0674" y="578.8872">Prepare OAuth request body</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.4629" x="726.0674" y="594.02">(grant_type, client_id, client_secret, audience)</text></g><g class="message" data-participant-1="Client" data-participant-2="AkuaAPI"><polygon fill="#181818" points="1312.9731,637.2188,1322.9731,641.2188,1312.9731,645.2188,1316.9731,641.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="719.0674" x2="1318.9731" y1="641.2188" y2="641.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.4688" x="726.0674" y="636.1528">POST /oauth/token</text></g><path d="M65,656.2188 L124.4429,656.2188 L124.4429,663.3516 L114.4429,673.3516 L60,673.3516 L60,661.2188 A5,5 0 0 1 65,656.2188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="234.8672" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1350.3184" x="60" y="656.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="75" y="669.2856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171.6548" x="139.4429" y="668.4292">[JWT Token Request Failed]</text><g class="message" data-participant-1="AkuaAPI" data-participant-2="Client"><polygon fill="#181818" points="730.0674,690.4844,720.0674,694.4844,730.0674,698.4844,726.0674,694.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="724.0674" x2="1323.9731" y1="694.4844" y2="694.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.6353" x="736.0674" y="689.4185">Error Response (400/500)</text></g><g class="message" data-participant-1="Client" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,719.6172,414.8706,723.6172,424.8706,727.6172,420.8706,723.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="713.0674" y1="723.6172" y2="723.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.2852" x="430.8706" y="718.5513">Return Error</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,748.75,112.1958,752.75,122.1958,756.75,118.1958,752.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="752.75" y2="752.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.7266" x="128.1958" y="747.6841">Failed to load JWT token</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="60" x2="1410.3184" y1="761.75" y2="761.75"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.4604" x="65" y="771.9604">[JWT Token Success]</text><g class="message" data-participant-1="AkuaAPI" data-participant-2="Client"><polygon fill="#181818" points="725.0674,807.8203,715.0674,811.8203,725.0674,815.8203,721.0674,811.8203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="719.0674" x2="1328.9731" y1="811.8203" y2="811.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="731.0674" y="791.6216">201 Created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.5718" x="731.0674" y="806.7544">{access_token, token_type, expires_in}</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#181818;stroke-width:2;" x1="714.0674" x2="756.0674" y1="840.9531" y2="840.9531"/><line style="stroke:#181818;stroke-width:2;" x1="756.0674" x2="756.0674" y1="840.9531" y2="853.9531"/><line style="stroke:#181818;stroke-width:2;" x1="715.0674" x2="756.0674" y1="853.9531" y2="853.9531"/><polygon fill="#181818" points="725.0674,849.9531,715.0674,853.9531,725.0674,857.9531,721.0674,853.9531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.8994" x="721.0674" y="835.8872">Store access_token</text></g><g class="message" data-participant-1="Client" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,879.0859,414.8706,883.0859,424.8706,887.0859,420.8706,883.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="713.0674" y1="883.0859" y2="883.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.5874" x="430.8706" y="878.02">JWT Token loaded</text></g><rect fill="#EEEEEE" height="3" rx="5" ry="5" style="stroke:#EEEEEE;stroke-width:1;" width="1440.3184" x="0" y="925.6523"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1440.3184" y1="925.6523" y2="925.6523"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1440.3184" y1="928.6523" y2="928.6523"/><rect fill="#EEEEEE" height="23.1328" rx="5" ry="5" style="stroke:#000000;stroke-width:2;" width="231.623" x="604.3477" y="915.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213.0972" x="610.3477" y="931.1528">Authorization Request Phase</text><g class="message" data-participant-1="CmdFlow" data-participant-2="AuthProvider"><polygon fill="#181818" points="1032.5303,965.3516,1042.5303,969.3516,1032.5303,973.3516,1036.5303,969.3516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="413.8706" x2="1038.5303" y1="969.3516" y2="969.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.6069" x="420.8706" y="964.2856">NewAuthorizationProvider()</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,994.4844,414.8706,998.4844,424.8706,1002.4844,420.8706,998.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="1048.5303" y1="998.4844" y2="998.4844"/><ellipse cx="436.3706" cy="988.9844" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.1084" x="442.8706" y="993.4185">AuthorizationProvider</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="CmdFlow"><line style="stroke:#181818;stroke-width:2;" x1="413.8706" x2="455.8706" y1="1103.2813" y2="1103.2813"/><line style="stroke:#181818;stroke-width:2;" x1="455.8706" x2="455.8706" y1="1103.2813" y2="1116.2813"/><line style="stroke:#181818;stroke-width:2;" x1="414.8706" x2="455.8706" y1="1116.2813" y2="1116.2813"/><polygon fill="#181818" points="424.8706,1112.2813,414.8706,1116.2813,424.8706,1120.2813,420.8706,1116.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.8462" x="420.8706" y="1022.5513">Prepare AuthorizeRequest:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.1128" x="420.8706" y="1037.6841">- Amount (currency, value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.5576" x="420.8706" y="1052.8169">- Intent (authorization/pre-authorization)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.1577" x="420.8706" y="1067.9497">- MerchantId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.7773" x="420.8706" y="1083.0825">- Instrument (card details)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.2622" x="420.8706" y="1098.2153">- Capture (mode: automatic/manual)</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="AuthProvider"><polygon fill="#181818" points="1032.5303,1141.4141,1042.5303,1145.4141,1032.5303,1149.4141,1036.5303,1145.4141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="413.8706" x2="1038.5303" y1="1145.4141" y2="1145.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.2593" x="420.8706" y="1140.3481">Authorize(ctx, client, requestData)</text></g><rect fill="#EEEEEE" height="3" rx="5" ry="5" style="stroke:#EEEEEE;stroke-width:1;" width="1440.3184" x="0" y="1173.9805"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1440.3184" y1="1173.9805" y2="1173.9805"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1440.3184" y1="1176.9805" y2="1176.9805"/><rect fill="#EEEEEE" height="23.1328" rx="5" ry="5" style="stroke:#000000;stroke-width:2;" width="197.5107" x="621.4038" y="1163.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.9849" x="627.4038" y="1179.481">Authorization Validation</text><g class="message" data-participant-1="AuthProvider" data-participant-2="Client"><polygon fill="#181818" points="730.0674,1213.6797,720.0674,1217.6797,730.0674,1221.6797,726.0674,1217.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="724.0674" x2="1043.5303" y1="1217.6797" y2="1217.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.6489" x="736.0674" y="1212.6138">JwtIsValid()</text></g><g class="message" data-participant-1="Client" data-participant-2="AuthProvider"><polygon fill="#181818" points="1032.5303,1242.8125,1042.5303,1246.8125,1032.5303,1250.8125,1036.5303,1246.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="714.0674" x2="1038.5303" y1="1246.8125" y2="1246.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.9849" x="721.0674" y="1241.7466">true/false</text></g><path d="M15,1261.8125 L74.4429,1261.8125 L74.4429,1268.9453 L64.4429,1278.9453 L10,1278.9453 L10,1266.8125 A5,5 0 0 1 15,1261.8125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1558.2031" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1420.3184" x="10" y="1261.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="1274.8794">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="121.043" x="89.4429" y="1274.0229">[JWT Token Invalid]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,1296.0781,414.8706,1300.0781,424.8706,1304.0781,420.8706,1300.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="1048.5303" y1="1300.0781" y2="1300.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.0288" x="430.8706" y="1295.0122">Error: ErrJWTTokenNotSet</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,1340.3438,112.1958,1344.3438,122.1958,1348.3438,118.1958,1344.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="1344.3438" y2="1344.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.5996" x="128.1958" y="1324.145">Authorization failed:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0005" x="128.1958" y="1339.2778">JWT token not set</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="1430.3184" y1="1353.3438" y2="1353.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110.4619" x="15" y="1363.5542">[JWT Token Valid]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="AuthProvider"><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1091.5303" y1="1388.2813" y2="1388.2813"/><line style="stroke:#181818;stroke-width:2;" x1="1091.5303" x2="1091.5303" y1="1388.2813" y2="1401.2813"/><line style="stroke:#181818;stroke-width:2;" x1="1050.5303" x2="1091.5303" y1="1401.2813" y2="1401.2813"/><polygon fill="#181818" points="1060.5303,1397.2813,1050.5303,1401.2813,1060.5303,1405.2813,1056.5303,1401.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.7134" x="1056.5303" y="1383.2153">json.Marshal(requestData)</text></g><path d="M25,1416.2813 L84.4429,1416.2813 L84.4429,1423.4141 L74.4429,1433.4141 L20,1433.4141 L20,1421.2813 A5,5 0 0 1 25,1416.2813" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1396.7344" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1400.3184" x="20" y="1416.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="1429.3481">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="135.4644" x="99.4429" y="1428.4917">[JSON Marshal Failed]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,1450.5469,414.8706,1454.5469,424.8706,1458.5469,420.8706,1454.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="1048.5303" y1="1454.5469" y2="1454.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.2852" x="430.8706" y="1449.481">Return Error</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,1479.6797,112.1958,1483.6797,122.1958,1487.6797,118.1958,1483.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="1483.6797" y2="1483.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.6323" x="128.1958" y="1478.6138">Failed to marshal request</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="20" x2="1420.3184" y1="1492.6797" y2="1492.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="147.0015" x="25" y="1502.8901">[JSON Marshal Success]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="Client"><polygon fill="#181818" points="730.0674,1523.6172,720.0674,1527.6172,730.0674,1531.6172,726.0674,1527.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="724.0674" x2="1048.5303" y1="1527.6172" y2="1527.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.6914" x="736.0674" y="1522.5513">GetAudience()</text></g><g class="message" data-participant-1="Client" data-participant-2="AuthProvider"><polygon fill="#181818" points="1037.5303,1552.75,1047.5303,1556.75,1037.5303,1560.75,1041.5303,1556.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="714.0674" x2="1043.5303" y1="1556.75" y2="1556.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.375" x="721.0674" y="1551.6841">audience URL</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="AuthProvider"><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1091.5303" y1="1601.0156" y2="1601.0156"/><line style="stroke:#181818;stroke-width:2;" x1="1091.5303" x2="1091.5303" y1="1601.0156" y2="1614.0156"/><line style="stroke:#181818;stroke-width:2;" x1="1050.5303" x2="1091.5303" y1="1614.0156" y2="1614.0156"/><polygon fill="#181818" points="1060.5303,1610.0156,1050.5303,1614.0156,1060.5303,1618.0156,1056.5303,1614.0156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.0298" x="1056.5303" y="1580.8169">Create HTTP POST Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.0322" x="1056.5303" y="1595.9497">POST {audience}/v1/authorizations</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="AuthProvider"><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1091.5303" y1="1658.2813" y2="1658.2813"/><line style="stroke:#181818;stroke-width:2;" x1="1091.5303" x2="1091.5303" y1="1658.2813" y2="1671.2813"/><line style="stroke:#181818;stroke-width:2;" x1="1050.5303" x2="1091.5303" y1="1671.2813" y2="1671.2813"/><polygon fill="#181818" points="1060.5303,1667.2813,1050.5303,1671.2813,1060.5303,1675.2813,1056.5303,1671.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.8833" x="1056.5303" y="1638.0825">Generate Idempotency-Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.4429" x="1056.5303" y="1653.2153">(amount.value + timestamp.UnixNano())</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="AuthProvider"><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1091.5303" y1="1745.8125" y2="1745.8125"/><line style="stroke:#181818;stroke-width:2;" x1="1091.5303" x2="1091.5303" y1="1745.8125" y2="1758.8125"/><line style="stroke:#181818;stroke-width:2;" x1="1050.5303" x2="1091.5303" y1="1758.8125" y2="1758.8125"/><polygon fill="#181818" points="1060.5303,1754.8125,1050.5303,1758.8125,1060.5303,1762.8125,1056.5303,1758.8125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.9668" x="1056.5303" y="1695.3481">Set Headers:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.4673" x="1056.5303" y="1710.481">- Authorization: Bearer {token}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.1328" x="1056.5303" y="1725.6138">- Idempotency-Key: {key}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2793" x="1056.5303" y="1740.7466">- Content-Type: application/json</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="Client"><polygon fill="#181818" points="730.0674,1783.9453,720.0674,1787.9453,730.0674,1791.9453,726.0674,1787.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="724.0674" x2="1048.5303" y1="1787.9453" y2="1787.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.1694" x="736.0674" y="1782.8794">GetHttpClient()</text></g><g class="message" data-participant-1="Client" data-participant-2="AuthProvider"><polygon fill="#181818" points="1037.5303,1813.0781,1047.5303,1817.0781,1037.5303,1821.0781,1041.5303,1817.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="714.0674" x2="1043.5303" y1="1817.0781" y2="1817.0781"/><ellipse cx="726.5674" cy="1807.5781" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.4531" x="733.0674" y="1812.0122">http.Client</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="AkuaAPI"><polygon fill="#181818" points="1312.9731,1857.3438,1322.9731,1861.3438,1312.9731,1865.3438,1316.9731,1861.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1318.9731" y1="1861.3438" y2="1861.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.0381" x="1056.5303" y="1841.145">POST /v1/authorizations</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.478" x="1056.5303" y="1856.2778">{requestBody with headers}</text></g><path d="M35,1876.3438 L94.4429,1876.3438 L94.4429,1883.4766 L84.4429,1893.4766 L30,1893.4766 L30,1881.3438 A5,5 0 0 1 35,1876.3438" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="929.6719" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1380.3184" x="30" y="1876.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="45" y="1889.4106">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="138.7031" x="109.4429" y="1888.5542">[HTTP Request Failed]</text><g class="message" data-participant-1="AkuaAPI" data-participant-2="AuthProvider"><polygon fill="#181818" points="1060.5303,1910.6094,1050.5303,1914.6094,1060.5303,1918.6094,1056.5303,1914.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="1054.5303" x2="1323.9731" y1="1914.6094" y2="1914.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.6128" x="1066.5303" y="1909.5435">Network Error</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,1954.875,414.8706,1958.875,424.8706,1962.875,420.8706,1958.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="1048.5303" y1="1958.875" y2="1958.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.2852" x="430.8706" y="1938.6763">Return Error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.6235" x="430.8706" y="1953.8091">(HTTP request failed)</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,1984.0078,112.1958,1988.0078,122.1958,1992.0078,118.1958,1988.0078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="1988.0078" y2="1988.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.9565" x="128.1958" y="1982.9419">Network error occurred</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="30" x2="1410.3184" y1="1997.0078" y2="1997.0078"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="150.2402" x="35" y="2007.2183">[HTTP Request Success]</text><g class="message" data-participant-1="AkuaAPI" data-participant-2="AuthProvider"><polygon fill="#181818" points="1060.5303,2027.9453,1050.5303,2031.9453,1060.5303,2035.9453,1056.5303,2031.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="1054.5303" x2="1328.9731" y1="2031.9453" y2="2031.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6484" x="1066.5303" y="2026.8794">HTTP Response</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="AuthProvider"><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1091.5303" y1="2061.0781" y2="2061.0781"/><line style="stroke:#181818;stroke-width:2;" x1="1091.5303" x2="1091.5303" y1="2061.0781" y2="2074.0781"/><line style="stroke:#181818;stroke-width:2;" x1="1050.5303" x2="1091.5303" y1="2074.0781" y2="2074.0781"/><polygon fill="#181818" points="1060.5303,2070.0781,1050.5303,2074.0781,1060.5303,2078.0781,1056.5303,2074.0781" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.3506" x="1056.5303" y="2056.0122">Read Response Body</text></g><g class="message" data-participant-1="AuthProvider" data-participant-2="AuthProvider"><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1091.5303" y1="2103.2109" y2="2103.2109"/><line style="stroke:#181818;stroke-width:2;" x1="1091.5303" x2="1091.5303" y1="2103.2109" y2="2116.2109"/><line style="stroke:#181818;stroke-width:2;" x1="1050.5303" x2="1091.5303" y1="2116.2109" y2="2116.2109"/><polygon fill="#181818" points="1060.5303,2112.2109,1050.5303,2116.2109,1060.5303,2120.2109,1056.5303,2116.2109" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.9604" x="1056.5303" y="2098.145">Check Status Code</text></g><path d="M45,2131.2109 L104.4429,2131.2109 L104.4429,2138.3438 L94.4429,2148.3438 L40,2148.3438 L40,2136.2109 A5,5 0 0 1 45,2131.2109" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="667.8047" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1223.0605" x="40" y="2131.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="55" y="2144.2778">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="186.9463" x="119.4429" y="2143.4214">[Status Code == 201 Created]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="AuthProvider"><line style="stroke:#181818;stroke-width:2;" x1="1049.5303" x2="1091.5303" y1="2184.6094" y2="2184.6094"/><line style="stroke:#181818;stroke-width:2;" x1="1091.5303" x2="1091.5303" y1="2184.6094" y2="2197.6094"/><line style="stroke:#181818;stroke-width:2;" x1="1050.5303" x2="1091.5303" y1="2197.6094" y2="2197.6094"/><polygon fill="#181818" points="1060.5303,2193.6094,1050.5303,2197.6094,1060.5303,2201.6094,1056.5303,2197.6094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.5044" x="1056.5303" y="2164.4106">json.Unmarshal(response)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.5303" x="1056.5303" y="2179.5435">to authorization.Authorization</text></g><path d="M55,2212.6094 L114.4429,2212.6094 L114.4429,2219.7422 L104.4429,2229.7422 L50,2229.7422 L50,2217.6094 A5,5 0 0 1 55,2212.6094" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="460.9375" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1092.5117" x="50" y="2212.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="65" y="2225.6763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152.7432" x="129.4429" y="2224.8198">[JSON Unmarshal Failed]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,2262.0078,414.8706,2266.0078,424.8706,2270.0078,420.8706,2266.0078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="1048.5303" y1="2266.0078" y2="2266.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.2852" x="430.8706" y="2245.8091">Return Error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.9067" x="430.8706" y="2260.9419">(JSON parsing failed)</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,2291.1406,112.1958,2295.1406,122.1958,2299.1406,118.1958,2295.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="2295.1406" y2="2295.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.0308" x="128.1958" y="2290.0747">Failed to parse response</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="50" x2="1142.5117" y1="2304.1406" y2="2304.1406"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="164.2803" x="55" y="2314.3511">[JSON Unmarshal Success]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,2350.2109,414.8706,2354.2109,424.8706,2358.2109,420.8706,2354.2109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="1048.5303" y1="2354.2109" y2="2354.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.6543" x="430.8706" y="2334.0122">Return *Authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.999" x="430.8706" y="2349.145">with status, transaction, etc.</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="CmdFlow"><line style="stroke:#181818;stroke-width:2;" x1="413.8706" x2="455.8706" y1="2428.7422" y2="2428.7422"/><line style="stroke:#181818;stroke-width:2;" x1="455.8706" x2="455.8706" y1="2428.7422" y2="2441.7422"/><line style="stroke:#181818;stroke-width:2;" x1="414.8706" x2="455.8706" y1="2441.7422" y2="2441.7422"/><polygon fill="#181818" points="424.8706,2437.7422,414.8706,2441.7422,424.8706,2445.7422,420.8706,2441.7422" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.2964" x="420.8706" y="2378.2778">Process Authorization Result:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.1968" x="420.8706" y="2393.4106">- Check status (approved/declined/rejected)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9287" x="420.8706" y="2408.5435">- Check status_detail</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.8535" x="420.8706" y="2423.6763">- Extract payment_id, transaction_id</text></g><path d="M65,2456.7422 L124.4429,2456.7422 L124.4429,2463.875 L114.4429,2473.875 L60,2473.875 L60,2461.7422 A5,5 0 0 1 65,2456.7422" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="209.8047" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="413.0039" x="60" y="2456.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="75" y="2469.8091">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="158.0605" x="139.4429" y="2468.9526">[Authorization Approved]</text><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,2521.2734,112.1958,2525.2734,122.1958,2529.2734,118.1958,2525.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="2525.2734" y2="2525.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.4668" x="128.1958" y="2489.9419">&#9989; Authorization Success</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.3916" x="128.1958" y="2505.0747">Payment ID: {id}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.6489" x="128.1958" y="2520.2075">Status: approved</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="60" x2="473.0039" y1="2534.2734" y2="2534.2734"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152.1309" x="65" y="2544.4839">[Authorization Declined]</text><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,2595.4766,112.1958,2599.4766,122.1958,2603.4766,118.1958,2599.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="2599.4766" y2="2599.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2041" x="128.1958" y="2564.145">&#10060; Authorization Declined</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="128.1958" y="2579.2778">Reason: {status_detail}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.6748" x="128.1958" y="2594.4106">(expired/fraudulent/insufficient_funds/etc.)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="60" x2="473.0039" y1="2608.4766" y2="2608.4766"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152.5874" x="65" y="2618.687">[Authorization Rejected]</text><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,2654.5469,112.1958,2658.5469,122.1958,2662.5469,118.1958,2658.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="2658.5469" y2="2658.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.4707" x="128.1958" y="2638.3481">&#10060; Authorization Rejected</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="128.1958" y="2653.481">Reason: {status_detail}</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="40" x2="1263.0605" y1="2681.5469" y2="2681.5469"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="215.5366" x="45" y="2691.7573">[Status Code == 400/404/500/etc.]</text><g class="message" data-participant-1="AuthProvider" data-participant-2="CmdFlow"><polygon fill="#181818" points="424.8706,2727.6172,414.8706,2731.6172,424.8706,2735.6172,420.8706,2731.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="418.8706" x2="1048.5303" y1="2731.6172" y2="2731.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.2852" x="430.8706" y="2711.4185">Return Error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293.2554" x="430.8706" y="2726.5513">Unexpected status code {code}: {message}</text></g><g class="message" data-participant-1="CmdFlow" data-participant-2="User"><polygon fill="#181818" points="122.1958,2787.0156,112.1958,2791.0156,122.1958,2795.0156,118.1958,2791.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:2;stroke-dasharray:2.0,2.0;" x1="116.1958" x2="412.8706" y1="2791.0156" y2="2791.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.2529" x="128.1958" y="2755.6841">&#10060; Authorization Failed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.8301" x="128.1958" y="2770.8169">Status: {code}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.6797" x="128.1958" y="2785.9497">Error: {message}</text></g><!--SRC=[fLZTRjis5BxtKn3TZRqbbbjqDm4om7NSrctZ18dT0OC1WvNecBL4QYILdmMvtDqUONkvFSaEVoIB-d6LDK5YcI8Fp_dudUySIL4L4pJXIHeJHT0uKrikw1zOKSxGsvZVeMDqYHyImfIUbM0MzNfoHrcA1KwG9BzdX8LaB0I_Msnfk6D4IlIgD4NmZ4KX5um8z79Kkl45XxiRStV2OoxG3s_7-hVNmw62ho-MaeWLwukCIHGcqU05mXBfmHwiLpIaAGQdNi2jO0EEoXNODOuERxYPEqaY7O4_7UyoF9p45ERPIUQoOGukGx5Y7ZANWj_IY0XZGT_91tmxOx23nfUp5GjkNmQUGMcNmWIut-kTdg8PeuhYECV-SeibGQUdFHqnElubZ-O4tN04cA0Yxc0VDi05o4cQq1WB5Dhp6cX0wIs6uyqHwRaBOzS0S8BcvCvUziiBB3hseppx4ySH8koM2iuCEMwneFXBJEJ9YXsZySVbU3tvD9lE5-lPMNNaUZgvcYwAqV7o38OdqsBWukhTU3xxRRoONSozvHVdvzEhoHJ66bpw3E15scaSnzerxP94M11WwJw4Cf8_ka4D6W46Yq4l8jNOUpXMxXfD176PWMbCeXw2dm9AiApFwWHT4PK9XgRQ8fp8EPMIifj6j0R6H7bJTq8abiJRbKJeEWj3oAvD5iSF_jR-kNouKmk-8wnlhLS3qcDsUGt2Iq5I3TY5vZGIEhcbGbzuz01nt0WWzLezfEG8XMR1caR5fIIX8Ee8uIoYMX46bIqSrM6FY-i52hZEXa1fDtqdyvGelDJmV_XrWKn8WAtrgNG0-iUjiiVhWZ7ummAPGheHr7yz6WK_ZqQ3Ob4J9SfdLqoiawBXJjdnPbvOdv7YADRPeuFQ0z320prikB27mD7WOEolHYzpsgpO8pOBrcQp8xkdEqTodr91v9gofqunrHXp3L8D6LVQu22y-oWq1AK3R8QOGBNHVreV_TAKyw2GoL8kb0NPw5gZTfTbpfFmyfUANZGQAck6PyXJsTn6dcAvAU8YiRAPG3a4FGep8I297ev0AEAC3FIz6LD6gxmo4gI277iZPkuv4U4MidKMsPLIYSpeJZ_48WAm5L1HcgaJd0BZ8JqI7f4JI5_54p0K1b0wCXmFUkt85Y7qGtMV2y5HBXjdME4sYEldwSHRNy9X-aUmPniesqoQgGUALCrF29u46mnPr2RlUrhEsAqsRzZNJWGZ3-O3Lfg5SwwkYQggkHTqioZuC6oCH00N2d50Z2jJm0uLYht_drkyhsBoLN8sF8S2kSLntpinNtYlB-R8JQjfRYiytnBH6YpVqil4UU0SxIQOPTThcjb2i7T4ZLq1w-yBHPlwjp8kBu9eUVMfGnLfTSktQWKTlLyiBcqLTTAnOkRROxxhKxtRxBZ3Em9TkjvZ5f4avKfhqF57egi_Dj8qD7g4VaAA9h0pJjBXaj7xEMQyFnXqt0KI1Rqd8F_2DOjbLq_G6mBwAD2ZeV-J4J3VcnFqk2CFviw46rKyNa0r0zZJDAQX5KPDy6y3N3htzqgbHGFylq_-nosO6RPt2PrFtc-NQWSALTqbmnlepj0TXNvjQp5zgdjVhUFx6P3ZXayjVLMrlwYMLdN7nQwIwDsr0MXbDiyRJQj-0y_IWMwaYweqAqlkk6dw4GzDlOtQ39UbfP0N3xMgl1o6pIsrVUbpWZq0SNMFA-32llVL77d6uicMX3jexR3Au04P-e9sBpI1IXEXU9TxJszgnwAqP4bHbgpxqAT03V3uF_GqexPDRQ2ePONr9gO_cxt69BHpvlckYRtFeMcNGgZt8aWqSQS3SJq2L-1eed1dFFp6UCMC74b32tZUWET6gNtYyF11L3ZyReGEm-Orsrm7LNjsa5bi6sxBTEifjDPf2jkIA8W8DBCCBWJvIa8Wyg0wUMrxQ3qylOS8GuNSQnZpK5oAUKsZxa5edlhEZfrFZTERwVBlttzMZBZ3XKR1lSgRdK4HfH7KK9kyfdQsxsC8uviySn0znwz__cenicAWLr8N_qSFNl2lRnzHes0ZeB_9Ol0-e4nccmqDpOk7JSOY6MXU3RhwVkLEzRjypusq-jxi3Ni66xgaSiMUYROYoFh5n-lHQ_to8sZClwvwjsHm62ReF6L2lSMZ_ly4yKDBAF4DgKVUDRcxu6x5S4zSk_kAkMUoJauqeLb6Chzsxn_-0m00]--></g></svg>